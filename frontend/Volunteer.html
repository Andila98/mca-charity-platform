<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Become a Volunteer - Ajelo Foundation</title>
    <link rel="stylesheet" href="volunteer.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">        
</head>
<body>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="logo" onclick="location.href='index.html'" style="cursor: pointer;">üè• Ajelo Foundation</div>
            <nav>
                <a href="index.html">Home</a>
                <a href="about us.html">About us</a>
                <a href="Impact.html">Impact</a>
                <a href="Get Involved.html">Get Involved</a>
                <a href="events.html">Events</a>
                <a href="Volunteer.html">Volunteer</a>
                <a href="Donate.html" class="btn btn-primary">Donate Now</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Become a Volunteer</h1>
            <p>Join our community of compassionate individuals making a difference in healthcare access.</p>
        </div>
    </section>

    <!-- Volunteer Form Section -->
    <section class="section">
        <div class="container">
            <div class="form-wrapper">
                <h2 class="section-title" style="margin-top: 0;">Volunteer Application</h2>

                <form id="volunteerForm" novalidate>
                    <div class="form-group">
                        <label for="volName" class="required">Full Name</label>
                        <input type="text" id="volName" name="name" placeholder="John Doe" required>
                        <span class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="volEmail" class="required">Email Address</label>
                        <input type="email" id="volEmail" name="email" placeholder="john@example.com" required>
                        <span class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="volPhone" class="required">Phone Number</label>
                        <input type="tel" id="volPhone" name="phone" placeholder="+254 712 345 678" required>
                        <span class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="volWard" class="required">Location/Ward</label>
                        <input type="text" id="volWard" name="ward" placeholder="e.g., Kibra, Nairobi" required>
                        <span class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label class="required">Areas of Interest</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="interest1" name="interests" value="Education">
                                <label for="interest1">Education</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="interest2" name="interests" value="Healthcare">
                                <label for="interest2">Healthcare</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="interest3" name="interests" value="Environment">
                                <label for="interest3">Environment</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="interest4" name="interests" value="Community Support">
                                <label for="interest4">Community</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="interest5" name="interests" value="Other">
                                <label for="interest5">Other</label>
                            </div>
                        </div>
                        <span class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="volBio">Why do you want to volunteer?</label>
                        <textarea id="volBio" name="bio" placeholder="Tell us about your motivation and what you hope to achieve..."></textarea>
                        <p class="form-hint">Optional - helps us understand your passion</p>
                    </div>

                    <button type="submit" class="btn-submit" id="submitBtn">
                        Register as Volunteer
                    </button>
                </form>

                <div class="success-message" id="successMessage">
                    <div class="success-icon">‚úÖ</div>
                    <h3>Thank You for Volunteering!</h3>
                    <p>Your registration has been submitted successfully.</p>
                    <p>We'll contact you soon to discuss volunteer opportunities.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2026 Ajelo Foundation. Compassion in Action.</p>
        </div>
    </footer>

    <script>
        const API_BASE = 'http://localhost:8080/api';
        const form = document.getElementById('volunteerForm');
        const successMessage = document.getElementById('successMessage');
        const submitBtn = document.getElementById('submitBtn');

        async function fetchAPI(endpoint, options = {}) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        function clearErrors() {
            form.querySelectorAll('.error-message').forEach(el => el.textContent = '');
        }

        function setError(fieldId, message) {
            const field = document.getElementById(fieldId);
            const errorEl = field.nextElementSibling;
            if (errorEl && errorEl.classList.contains('error-message')) {
                errorEl.textContent = message;
            }
        }

        function setInterestError(message) {
            const checkboxes = form.querySelectorAll('input[name="interests"]');
            const lastCheckbox = checkboxes[checkboxes.length - 1];
            const errorEl = lastCheckbox.closest('.form-group').querySelector('.error-message');
            if (errorEl) {
                errorEl.textContent = message;
            }
        }

        function validateForm() {
            clearErrors();
            let isValid = true;

            const name = document.getElementById('volName').value.trim();
            if (!name) {
                setError('volName', 'Please enter your full name');
                isValid = false;
            }

            const email = document.getElementById('volEmail').value.trim();
            if (!email) {
                setError('volEmail', 'Please enter your email address');
                isValid = false;
            } else if (!/^\S+@\S+\.\S+$/.test(email)) {
                setError('volEmail', 'Please enter a valid email address');
                isValid = false;
            }

            const phone = document.getElementById('volPhone').value.trim();
            if (!phone) {
                setError('volPhone', 'Please enter your phone number');
                isValid = false;
            } else if (phone.replace(/\D/g, '').length < 9) {
                setError('volPhone', 'Please enter a valid phone number');
                isValid = false;
            }

            const ward = document.getElementById('volWard').value.trim();
            if (!ward) {
                setError('volWard', 'Please enter your location/ward');
                isValid = false;
            }

            const selectedInterests = Array.from(
                form.querySelectorAll('input[name="interests"]:checked')
            ).map(cb => cb.value);

            if (selectedInterests.length === 0) {
                setInterestError('Please select at least one area of interest');
                isValid = false;
            }

            return isValid;
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!validateForm()) {
                return;
            }

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="loading-spinner"></span>Submitting...';

            try {
                const name = document.getElementById('volName').value.trim();
                const email = document.getElementById('volEmail').value.trim();
                const phone = document.getElementById('volPhone').value.trim();
                const ward = document.getElementById('volWard').value.trim();
                const interests = Array.from(
                    form.querySelectorAll('input[name="interests"]:checked')
                ).map(cb => cb.value);
                const bio = document.getElementById('volBio').value.trim();

                const response = await fetchAPI('/v1/volunteers', {
                    method: 'POST',
                    body: JSON.stringify({
                        name,
                        email,
                        phone,
                        ward,
                        interests,
                        bio
                    })
                });

                form.style.display = 'none';
                successMessage.classList.add('show');

                // Scroll to success message
                successMessage.scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error('Submission error:', error);
                alert('There was an error submitting your application. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Register as Volunteer';
            }
        });
    </script>
</body>
</html>