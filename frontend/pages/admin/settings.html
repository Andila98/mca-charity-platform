<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Settings - Admin</title>
    <link rel="stylesheet" href="../../css/base.css">
    <link rel="stylesheet" href="../../css/layout.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/pages/admin/admin.css">
    <link rel="stylesheet" href="../../css/responsive.css">
    <style>
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        .setting-card {
            background-color: var(--color-surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
        }
        .setting-card h3 {
            margin-top: 0;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.75rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body class="admin-layout">
<aside class="admin-sidebar">
    <div class="sidebar-logo">Charity Admin</div>

    <nav class="sidebar-nav">
        <a href="dashboard.html" class="nav-item">
            <span class="nav-icon">ğŸ“Š</span>
            <span class="nav-text">Dashboard</span>
        </a>
        <a href="projects.html" class="nav-item">
            <span class="nav-icon">ğŸ“</span>
            <span class="nav-text">Projects</span>
        </a>
        <a href="events.html" class="nav-item">
            <span class="nav-icon">ğŸ“…</span>
            <span class="nav-text">Events</span>
        </a>
        <a href="donations.html" class="nav-item">
            <span class="nav-icon">ğŸ’°</span>
            <span class="nav-text">Donations</span>
        </a>
        <a href="volunteers.html" class="nav-item">
            <span class="nav-icon">ğŸ¤</span>
            <span class="nav-text">Volunteers</span>
        </a>
        <a href="users.html" class="nav-item">
            <span class="nav-icon">ğŸ‘¥</span>
            <span class="nav-text">Users</span>
        </a>
        <a href="content.html" class="nav-item">
            <span class="nav-icon">ğŸ“</span>
            <span class="nav-text">Content</span>
        </a>
        <a href="activity.html" class="nav-item">
            <span class="nav-icon">ğŸ“œ</span>
            <span class="nav-text">Activity Logs</span>
        </a>
        <a href="settings.html" class="nav-item active">
            <span class="nav-icon">âš™ï¸</span>
            <span class="nav-text">Settings</span>
        </a>
    </nav>

    <div class="sidebar-footer">
        <button id="logout-btn" class="nav-item" style="width: 100%; border: none; background: none; cursor: pointer;">
            <span class="nav-icon">ğŸšª</span>
            <span class="nav-text">Logout</span>
        </button>
    </div>
</aside>

<main class="admin-main">
    <header class="admin-header">
        <div class="header-left">
            <span class="breadcrumb">Admin / Settings</span>
            <h1>Application Settings</h1>
        </div>
        <div class="header-right">
            <div class="user-pill">
                <span id="user-name">Loading...</span>
                <small id="user-role">Super Admin</small>
            </div>
        </div>
    </header>

    <div class="admin-content">
        <div class="settings-grid">
            <div class="setting-card">
                <h3>General Settings</h3>
                <p>Placeholder for general application settings like site title, contact email, etc.</p>
                <button class="btn btn-secondary" disabled>Edit General Settings</button>
            </div>

            <div class="setting-card">
                <h3>Cache Management</h3>
                <p>Clear server-side caches to ensure the latest data is being served. This can resolve some display issues.</p>
                <button id="clear-cache-btn" class="btn btn-warning">Clear All Caches</button>
            </div>

            <div class="setting-card">
                <h3>Security Settings</h3>
                <p>Configure password policies, session timeouts, and other security-related options.</p>
                <button class="btn btn-secondary" disabled>Configure Security</button>
            </div>

            <div class="setting-card">
                <h3>Integrations</h3>
                <p>Manage API keys for third-party services like email providers or payment gateways.</p>
                <button class="btn btn-secondary" disabled>Manage Integrations</button>
            </div>
        </div>
    </div>
</main>

<script src="../../js/services/api.service.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const clearCacheBtn = document.getElementById('clear-cache-btn');
        if (clearCacheBtn) {
            clearCacheBtn.addEventListener('click', handleClearCache);
        }
    });

    async function handleClearCache() {
        if (!confirm('Are you sure you want to clear all server caches? This might temporarily slow down the application.')) {
            return;
        }

        // NOTE: This assumes a backend endpoint /api/v1/admin/cache/clear exists.
        // This is a hypothetical endpoint for demonstration.
        try {
            // Using a generic admin endpoint as an example
            await adminAPI.post('/admin/cache/clear', {});
            alert('Server caches have been cleared successfully.');
        } catch (error) {
            // It's likely this endpoint doesn't exist, so we'll simulate success for now.
            if (error.message.includes('404')) {
                 alert('Cache clearing is a demo feature. Endpoint not yet implemented on the backend, but the request was simulated.');
            } else {
                alert(`An error occurred: ${error.message}`);
            }
        }
    }
</script>
</body>
</html>